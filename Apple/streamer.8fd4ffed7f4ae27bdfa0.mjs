/*! For license information please see streamer.8fd4ffed7f4ae27bdfa0.mjs.LICENSE.txt */
(()=>{"use strict";var e={8277:(e,t,s)=>{s.r(t);var r=s(3379),n=s.n(r),i=s(9037),o=s.n(i),a=s(569),c=s.n(a),l=s(3565),u=s.n(l),d=s(9216),b=s.n(d),f=s(1603),m={};m.setAttributes=u(),m.insert=c().bind(null,"head"),m.domAPI=o(),m.insertStyleElement=b(),n()(f.Z,m);const h=f.Z&&f.Z.locals?f.Z.locals:void 0;function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},p.apply(this,arguments)}const y="streamer",g="txt",v="data-field",w="data-symbol",k="data-stream",S="value",C="active";class M extends HTMLElement{constructor(){super(),this.initialized=!1,this.cssToggle=!1,this.value=void 0,this.transform=null,this.onUpdate=this.onUpdate.bind(this)}static get observedAttributes(){return[w,v,C]}onUpdate(e,{field:t,quote:s}={}){if(!e&&"number"!=typeof e)return;const r="object"!=typeof e?{raw:e,fmt:e}:e,{raw:n}=r;if(this.value!==n){const e=this.getAttribute("changeev");e&&this.dispatchEvent(new CustomEvent(`finWebCore_${e}`,{detail:p({},r,{field:t,quote:s}),bubbles:!0})),this.cssToggle=!this.cssToggle;const i=n-this.value;this.value=n,this.render(p({},r,{trend:i}))}}subscribe({symbols:e,fields:t}){var s;e&&t&&e.length&&t.length&&this.hasAttribute(C)&&"function"==typeof(null==(s=window.finQuoteStreamer)?void 0:s.subscribe)&&window.finQuoteStreamer.subscribe({symbols:e,fields:t,type:this.getAttribute(k)||y,priceHint:this.getAttribute("data-pricehint"),formatStyle:this.getAttribute("data-fstyle"),callback:this.onUpdate})}unsubscribe({symbols:e,fields:t}){var s;e&&t&&e.length&&t.length&&"function"==typeof(null==(s=window.finQuoteStreamer)?void 0:s.unsubscribe)&&window.finQuoteStreamer.unsubscribe({symbols:e,fields:t,type:this.getAttribute(k)||y,callback:this.onUpdate})}connectedCallback(){if(!this.initialized){const e=this.getAttribute(v),t=this.getAttribute(w);this.value=parseFloat(this.getAttribute(S)||""),t&&e&&this.subscribe({symbols:[t],fields:[e]}),this.initialized=!0}}disconnectedCallback(){const e=this.getAttribute(v),t=this.getAttribute(w);t&&e&&this.unsubscribe({symbols:[t],fields:[e]}),this.initialized=!1}attributeChangedCallback(e,t,s){if(this.initialized)switch(e){case w:t!==s&&s&&(this.unsubscribe({symbols:[t],fields:[this.getAttribute(v)]}),this.subscribe({symbols:[s],fields:[this.getAttribute(v)]}));break;case v:t!==s&&s&&(this.unsubscribe({symbols:[this.getAttribute(w)],fields:[t]}),this.subscribe({symbols:[this.getAttribute(w)],fields:[s]}));break;case C:{const e=null!==t,r=null!==s;e&&!r?this.unsubscribe({symbols:[this.getAttribute(w)],fields:[this.getAttribute(v)]}):!e&&r&&this.subscribe({symbols:[this.getAttribute(w)],fields:[this.getAttribute(v)]})}break;case S:this.value=parseFloat(s)}}render(e){"function"==typeof this.transform&&(e=this.transform(e));const{raw:t,trend:s}=e,r=this.getAttribute("data-trend")||g,n=this.getAttribute("data-template"),i=this.getAttribute("data-dfield")||"fmt",o="arrow"===this.getAttribute("data-tstyle");let a=h.base,c="";if(t>0)switch(r){case"bg":a+=` ${h.posBgColor}`,c=o?"↑ ":"+";break;case g:a+=` ${h.posColor}`,c=o?"↑ ":"+"}else if(t<0)switch(r){case"bg":a+=` ${h.negBgColor}`,o&&(c="↓ ");break;case g:a+=` ${h.negColor}`,o&&(c="↓ ")}s>0?a+=` ${this.cssToggle?h.trendUp1:h.trendUp2}`:s<0&&(a+=` ${this.cssToggle?h.trendDown1:h.trendDown2}`);let l=c+(e[i]||"");o&&(l=l.replace("-","")),n&&(l=function(e,t){let s=e,r=!1;return Object.keys(t).forEach((e=>{t[e]&&(r=!0),s=s.replace(new RegExp(`{${e}}`,"g"),t[e])})),r?s:""}(n,{raw:t,fmt:l})),this.children[0]?(this.children[0].className=a,this.children[0].textContent=l):this.innerHTML=`<span class="${a}">${l}</span>`}}window.customElements&&!window.customElements.get("fin-streamer")&&window.customElements.define("fin-streamer",M)},1603:(e,t,s)=>{s.d(t,{Z:()=>a});var r=s(8081),n=s.n(r),i=s(3645),o=s.n(i)()(n());o.push([e.id,'.a405bf5d{color:blue}.e3b14781{position:relative;white-space:nowrap;z-index:0}.e3b14781:before,.a7c78a61{content:"";display:block;height:100%;left:0;opacity:0;position:absolute;top:0;width:100%;z-index:-1}.e3b14781:before{background-color:#00853c1a}.e3b14781:after{background-color:#bd14141a;content:"";display:block;height:100%;left:0;opacity:0;position:absolute;top:0;width:100%;z-index:-1}.f4be3290{color:#007560}.ee3e99dd{color:#bd1414}.b3c3f2ca{background-color:#007560}.cd7d43ff,.b3c3f2ca{border-radius:3px;color:#fff;padding:2px 10px}.cd7d43ff{background-color:#bd1414}.a6c2a027{font-size:12px}.f5193b25{font-size:14px;font-weight:700}.bf673e9a{font-weight:500;margin-left:4px}@keyframes ed961825{25%{display:block;opacity:1}75%{opacity:1}to{display:none;opacity:0}}@keyframes de628db8{25%{display:block;opacity:1}75%{opacity:1}to{display:none;opacity:0}}@keyframes e816a496{25%{display:block;opacity:1}75%{opacity:1}to{display:none;opacity:0}}@keyframes f90c4216{25%{display:block;opacity:1}75%{opacity:1}to{display:none;opacity:0}}.e887be10{background-color:#00853c1a}.b0e44130{background-color:#bd14141a}.f5a023e1:before{animation:ed961825 .7s}.e983cf79:before{animation:de628db8 .7s}.e59c8479:after{animation:e816a496 .7s}.dde7f18a:after{animation:f90c4216 .7s}',""]),o.locals={primaryColor:"#232a31",secondaryColor:"#464e56",tertiaryColor:"#5b636a",tertiaryColor2:"#6e7780",layoutBgColor:"#fff",headerBgColor:"#f5f8fa",lv1BgColor:"#f0f3f5",lv2BgColor:"#fff",lv3BgColor:"#fff",seperatorColor:"#e0e4e9",linkColor:"#0f69ff",linkActiveColor:"#125bd4",hoverBgColor:"#e0f0ff",iconColor:"#5b636a",positiveColor:"#007560",negativeColor:"#bd1414",neutralColor:"#5b636a",positiveBgColor:"#00853c1a",negativeBgColor:"#bd14141a",activeMarketColor:"#ff7b12","c-fuji-blurple":"#5d5eff",linkSelectedColor:"#7e1fff","c-fuji-grape-jelly":"#6001d2",boxShadow:"0 2px 4px rgba(0,0,0,.2)",overlayModalBgColor:"rgba(50,50,50,0.6)",newsItemWidth:"calc(100% - 50px)",xs:"11px",xss:"12px",s:"13px",sm:"14px",m:"15px",ml:"16px",l:"18px",dummy:"a405bf5d",base:"e3b14781",baseCommon:"a7c78a61",posColor:"f4be3290",negColor:"ee3e99dd",posBgColor:"b3c3f2ca",negBgColor:"cd7d43ff",marketNotice:"a6c2a027",prepostCont:"f5193b25",prepostChange:"bf673e9a",trendUp:"e887be10",trendDown:"b0e44130",trendUp1:"f5a023e1",trendAnimUp1:"ed961825",trendUp2:"e983cf79",trendAnimUp2:"de628db8",trendDown1:"e59c8479",trendAnimDown1:"e816a496",trendDown2:"dde7f18a",trendAnimDown2:"f90c4216"};const a=o},3645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s="",r=void 0!==t[5];return t[4]&&(s+="@supports (".concat(t[4],") {")),t[2]&&(s+="@media ".concat(t[2]," {")),r&&(s+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),s+=e(t),r&&(s+="}"),t[2]&&(s+="}"),t[4]&&(s+="}"),s})).join("")},t.i=function(e,s,r,n,i){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(o[c]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);r&&o[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),s&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=s):u[2]=s),n&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=n):u[4]="".concat(n)),t.push(u))}},t}},8081:e=>{e.exports=function(e){return e[1]}},3379:e=>{var t=[];function s(e){for(var s=-1,r=0;r<t.length;r++)if(t[r].identifier===e){s=r;break}return s}function r(e,r){for(var i={},o=[],a=0;a<e.length;a++){var c=e[a],l=r.base?c[0]+r.base:c[0],u=i[l]||0,d="".concat(l," ").concat(u);i[l]=u+1;var b=s(d),f={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==b)t[b].references++,t[b].updater(f);else{var m=n(f,r);r.byIndex=a,t.splice(a,0,{identifier:d,updater:m,references:1})}o.push(d)}return o}function n(e,t){var s=t.domAPI(t);return s.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;s.update(e=t)}else s.remove()}}e.exports=function(e,n){var i=r(e=e||[],n=n||{});return function(e){e=e||[];for(var o=0;o<i.length;o++){var a=s(i[o]);t[a].references--}for(var c=r(e,n),l=0;l<i.length;l++){var u=s(i[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=c}}},569:e=>{var t={};e.exports=function(e,s){var r=function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(s)}},9216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,s)=>{e.exports=function(e){var t=s.nc;t&&e.setAttribute("nonce",t)}},9037:e=>{var t,s=(t=[],function(e,s){return t[e]=s,t.filter(Boolean).join("\n")});function r(e,t,r,n){var i;if(r)i="";else{i="",n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,o&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}")}if(e.styleSheet)e.styleSheet.cssText=s(t,i);else{var a=document.createTextNode(i),c=e.childNodes;c[t]&&e.removeChild(c[t]),c.length?e.insertBefore(a,c[t]):e.appendChild(a)}}var n={singleton:null,singletonCounter:0};e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=n.singletonCounter++,s=n.singleton||(n.singleton=e.insertStyleElement(e));return{update:function(e){r(s,t,!1,e)},remove:function(e){r(s,t,!0,e)}}}},477:e=>{e.exports=function(e,t,s,r){var n=self||window;try{try{var i;try{i=new n.Blob([e])}catch(t){(i=new(n.BlobBuilder||n.WebKitBlobBuilder||n.MozBlobBuilder||n.MSBlobBuilder)).append(e),i=i.getBlob()}var o=n.URL||n.webkitURL,a=o.createObjectURL(i),c=new n[t](a,s);return o.revokeObjectURL(a),c}catch(r){return new n[t]("data:application/javascript,".concat(encodeURIComponent(e)),s)}}catch(e){if(!r)throw Error("Inline worker is not supported");return new n[t](r,s)}}}},t={};function s(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,s),i.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.p="https://s.yimg.com/uc/finance/webcore/",s.nc=void 0,(()=>{var e=s(477),t=s.n(e);function r(){return t()('/*! For license information please see streamer.worker.15a4b08ae4ff023744e1.worker.mjs.LICENSE.txt */\n(()=>{try{"function"==typeof importScripts&&(importScripts("https://cdn.jsdelivr.net/npm/protobufjs@7.1.2/dist/minimal/protobuf.min.js"),importScripts("https://s.yimg.com/uc/finance/webcore/js/_staticFinProtobuf.24b255894e18be2e8799.mjs"))}catch(e){console.error("> Finance Streamer: Importing protobuff failed.",e)}let e=null,t=null;const s={id:"symbol",dayVolume:"volume",dayHigh:"high",dayLow:"low",marketcap:"marketCap",marketHours:"marketState",openPrice:"regularMarketOpen",fromcurrency:"fromCurrency",vol_24hr:"volume24Hr",volAllCurrencies:"volumeAllCurrencies"},n={ask:!0,askSize:!0,bid:!0,bidSize:!0,dayLow:!0,dayHigh:!0,expireDate:!0},i={},r={change:!0,changePercent:!0,previousClose:!0,price:!0},o={_permanent:!0};function c(e,t){let s;return(...n)=>{clearTimeout(s),s=setTimeout((()=>e(...n)),t)}}function a(e,t){if(isNaN(e))return e;const s=Math.pow(10,t);return+Math.round(e*s)/s}class l{constructor(){this.crumb="",this.symbolList=[],this.fieldList=[],this.connection=null}update({crumb:e,symbols:t,fields:s}){this.crumb=e||"",this.symbolList=t,this.fieldList=s}reset(){this.fieldList=[],this.symbolList=[]}}class u extends l{constructor(){super(),this.intervalHandle=null,this.handleQuoteRequest=this.handleQuoteRequest.bind(this),this.subscribe=c(this.subscribe.bind(this),1e3)}resetPoller(){this.intervalHandle&&clearInterval(this.intervalHandle),this.intervalHandle=setInterval((()=>{!function(e,{timeout:t=1e3,callback:s}){const n=new XMLHttpRequest;n.timeout=t,n.open("GET",e,!0),n.onload=()=>{let e=n.responseText;if(n.status>=200&&n.status<300&&e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return void s({status:502,message:e.message})}s(null,e)}else s({status:n.status||502,message:n.responseText})},n.onerror=()=>{s({status:n.status||500,message:n.responseText})},n.send()}(`https://query1.finance.yahoo.com/v7/finance/quote?&symbols=${this.symbolList.sort().join(",")}&fields=${this.fieldList.filter((e=>!o[e])).join(",")}&crumb=${this.crumb||""}`,{callback:this.handleQuoteRequest})}),5e3)}subscribe(e){const{crumb:t,symbols:s=[],fields:n=[]}=e||{},i=s.length>this.symbolList.length,r=n.length>this.fieldList.length;this.update({crumb:t,symbols:s,fields:n}),(i||r)&&this.resetPoller()}unsubscribe(e){const{crumb:t,symbols:s=[],fields:n=[]}=e||{},i=s.length<this.symbolList.length,r=n.length<this.fieldList.length;this.update({crumb:t,symbols:s,fields:n}),(i||r)&&(0!==this.symbolList.length?this.resetPoller():this.destroy())}destroy(){this.reset(),this.intervalHandle&&(clearInterval(this.intervalHandle),this.intervalHandle=null)}handleQuoteRequest(e,t){if(!e&&t){const e={type:"poller",quoteData:{}},s=t.quoteResponse&&t.quoteResponse.result;for(let t=0;t<s.length;t++){const n=s[t],{symbol:i}=n;e.quoteData[i]={price:n,summaryDetail:{}}}postMessage(e)}else console.error("> Error from Finance Quote Streamer:",e)}}class h extends l{constructor(){super(),this.connection=null,this.retries=0,this.sendConnection=c(this.sendConnection.bind(this),1e3)}subscribe(e){var t,s;const{crumb:n,symbols:i=[],fields:r=[]}=e||{};if(this.update({crumb:n,symbols:i,fields:r}),!this.connection||(null==(t=this.connection)?void 0:t.readyState)!==WebSocket.OPEN&&(null==(s=this.connection)?void 0:s.readyState)!==WebSocket.CONNECTING){const e=()=>{this.retries>10||(this.connection=new WebSocket("wss://streamer.finance.yahoo.com"),this.connection.addEventListener("open",(()=>{this.connection.send(JSON.stringify({subscribe:this.symbolList}))})),this.connection.addEventListener("error",(t=>{t&&"ECONNREFUSED"===t.code&&(this.retries++,e())})),this.connection.addEventListener("close",(t=>{t&&1e3!==t.code&&(this.retries++,e())})),this.connection.addEventListener("message",this.handleWebSocketUpdate))};e()}else this.connection.readyState===WebSocket.OPEN&&this.symbolList.length>0&&this.sendConnection(JSON.stringify({subscribe:this.symbolList}))}unsubscribe(e){var t;const{crumb:s,symbols:n=[],fields:i=[]}=e||{},r=new Set(n),o=this.symbolList.filter((e=>!r.has(e)));this.update({crumb:s,symbols:n,fields:i}),(null==(t=this.connection)?void 0:t.readyState)===WebSocket.OPEN&&o.length>0&&this.sendConnection(JSON.stringify({unsubscribe:o}))}destroy(){this.reset(),this.connection&&(this.connection.close(),this.connection=null)}sendConnection(e){this.connection.send(e)}handleWebSocketUpdate(e){try{const{PricingData:t}=protobuf.roots.default.quotefeeder,o=function(e){const t=atob(e),s=t.length,n=new Uint8Array(s);for(let e=0;e<s;e++)n[e]=t.charCodeAt(e);return n}(e.data);let c=t.decode(o);c=t.toObject(c,{enums:String});const l={};Array.isArray(c)||(c=[c]),c.forEach((e=>{null!=e&&e.id&&(l[e.id]=function(e){const t={},o={},{marketHours:c}=e,l=e.priceHint||2;let u,h="";switch(c){case"PRE_MARKET":h="preMarket",u="PRE";break;case"REGULAR_MARKET":h="regularMarket",u="REGULAR";break;case"POST_MARKET":h="postMarket",u="POST";break;case"EXTENDED_HOURS_MARKET":h="extendedMarket",u="EXTENDED"}for(const c in e)if(Object.prototype.hasOwnProperty.call(e,c)){let d=s[c]||c,b=e[c];if(null==b||""===b)continue;switch(d){case"previousClose":case"price":case"time":case"dayHigh":case"dayLow":case"volume":case"changePercent":case"change":r[d]&&!isNaN(b)&&(b=a(b,l)),"time"===d&&(b/=1e3),d=h+d[0].toUpperCase()+d.substr(1);break;case"marketState":b=u}n[d]?o[d]=b:i[d]||(t[d]=b)}return{price:t,summaryDetail:o}}(e))})),postMessage({type:"streamer",quoteData:l})}catch(e){console.error("> Error from Finance Quote Streamer:",e)}}}function d(s="streamer"){return"poller"===s?(t||(t=new u(s)),t):(e||(e=new h(s)),e)}protobuf||console.error("> Finance Streamer: Protobuff library missing so cannot use streamer"),addEventListener("message",(s=>{const{data:n}=s,{type:i}=n||{};switch(n.cmd){case"subscribe":d(i).subscribe(n);break;case"unsubscribe":d(i).unsubscribe(n);break;case"destroy":"poller"===i&&t&&(t.destroy(),t=null),"streamer"===i&&e&&(e.destroy(),e=null)}}),!1)})();',"Worker",void 0,s.p+"js/streamer.worker.15a4b08ae4ff023744e1.worker.mjs")}function n(e="error",t,s={}){try{var r;if("function"==typeof(null==(r=window.context)?void 0:r.getActionContext)){const r=window.context.getActionContext();"function"==typeof r.beacon&&r.beacon(e,t,s)}else console["error"===e?"error":"log"](e,t,JSON.stringify(s))}catch(e){console.error(e)}}function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},i.apply(this,arguments)}const o=["https://query1.finance.yahoo.com","https://query2.finance.yahoo.com"];function a(){const e=Math.floor(Math.random()*o.length);return o[e]}function c(e,{method:t="GET",withCredentials:s=!0,headers:r={},body:o,timeout:a=1e3,errorMsg:c="Request failed",beaconString:l="financeWebCore",isFetchDisabled:u=!1,returnErrorInfo:d=!1}={}){return new Promise(((b,f)=>{const m=Date.now();function h(t={}){"object"==typeof t&&t&&(t.timestamp=m),n("info",l,{code:200,surl:e}),b(t)}function p(t={}){t.status=t.status||500,t.message=t.message||c,n("error",l,{code:t.status,msg:t.message,surl:e}),f(t)}u||void 0===window.fetch?function(e,{method:t="GET",withCredentials:s=!0,headers:r={},body:n,timeout:o=1e3,successCb:a,errorCb:c}){const l=new window.XMLHttpRequest;l.open(t,e,!0),l.timeout=o,l.withCredentials=s,l.onload=()=>{let e=l.responseText;if(l.status>=200&&l.status<300){if("string"==typeof e)try{e=""!==e?JSON.parse(e):{}}catch(e){return void c({status:502,message:e.message})}a(e)}else c({status:l.status||502,message:l.responseText})},l.onerror=()=>{c({status:l.status||500,message:l.responseText})};const u=i({},"GET"!==t?{"Content-Type":"application/json"}:{},r);Object.keys(u).forEach((e=>{l.setRequestHeader(e,u[e])})),l.send(n?JSON.stringify(n):void 0)}(e,{method:t,withCredentials:s,headers:r,body:o,timeout:a,successCb:h,errorCb:p}):function(e,{method:t="GET",withCredentials:s=!0,headers:r={},body:n,returnErrorInfo:o,timeout:a=1e3,successCb:c,errorCb:l}){const u=new window.AbortController;let d=!1;const b=setTimeout((function(){d=!0,u.abort(),clearTimeout(b),l({status:502,message:"Request Timeout"})}),a);window.fetch(e,{method:t,mode:"cors",credentials:s?"include":"omit",headers:i({},"GET"!==t?{"Content-Type":"application/json"}:{},r),signal:u.signal,body:n?JSON.stringify(n):null}).then((async e=>{if(!d){if(clearTimeout(b),!e.ok){let n;var t,s,r;if(o)n=null==(r=((null==(t=e.headers)||null==t.get||null==(s=t.get("content-type"))?void 0:s.includes("application/json"))?await e.json():{}).finance)?void 0:r.error;return Promise.reject(i({status:e.status||502,message:e.statusText},n&&{info:n}))}return e.text()}})).then((e=>{let t=e;"application/json"===((null==r?void 0:r["Content-Type"])||"application/json")&&(t=""!==e?JSON.parse(e):{}),c(t)})).catch((e=>{d||l(i({status:e.status||502,message:e.message},e.info&&{info:e.info}))}))}(e,{method:t,withCredentials:s,headers:r,body:o,returnErrorInfo:d,timeout:a,successCb:h,errorCb:p})}))}function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},l.apply(this,arguments)}function u({field:e,value:t,lang:s="en-US",priceHint:r,gmtOffSetMilliseconds:n,timeZoneShort:i,formatStyle:o}){const a={raw:t};switch(e){case"regularMarketVolume":case"marketCap":a.fmt=function(e,t=3){const s=Math.abs(e);return s>=1e12?`${(e/1e12).toFixed(t)}T`:s>=1e9?`${(e/1e9).toFixed(t)}B`:s>=1e6?`${(e/1e6).toFixed(t)}M`:s>=1e3?`${(e/1e3).toFixed(t)}k`:e.toFixed(0)}(t),a.longFmt=Intl.NumberFormat(s,{maximumFractionDigits:0}).format(t);break;case"extendedMarketChangePercent":case"postMarketChangePercent":case"preMarketChangePercent":case"regularMarketChangePercent":{let e=t;isNaN(t)||(e=t/100);const n=r?{minimumFractionDigits:r,maximumFractionDigits:r}:{minimumFractionDigits:2,maximumFractionDigits:4};a.fmt=Intl.NumberFormat(s,l({},n,{style:"percent"})).format(e);break}case"extendedMarketTime":case"preMarketTime":case"postMarketTime":case"regularMarketTime":a.fmt=i&&"number"==typeof n?function(e,t,s){let r="string"==typeof(n=t)?Number(n):"number"==typeof n?n:"object"==typeof n&&n instanceof Date?n.getTime():Date.now();var n;return void 0!==e.gmtOffSetMilliseconds&&("string"==typeof e.gmtOffSetMilliseconds&&(e.gmtOffSetMilliseconds=Number(e.gmtOffSetMilliseconds)),i=r,o=e.gmtOffSetMilliseconds,r=isNaN(o)?i:i+6e4*new Date(i).getTimezoneOffset()+o),function(e,t={}){const{useUTC:s=!1,fmt:r="%I:%M%P",timeZoneShort:n=""}=t;let i="",o="",a="",c="",l=0,u=0,d="";for(;-1!==(u=r.indexOf("%",u));){switch(l!==u&&(c+=r.substring(l,u)),u+=1,d=r[u],d){case"l":case"I":o||(o=s?e.getUTCHours():e.getHours(),o<12?(o=0===o?"12":String(o),i="am"):(o>12&&(o-=12),o=String(o),i="pm")),"I"===d&&1===o.length?c+=`0${o}`:c+=o;break;case"M":a||(a=String(s?e.getUTCMinutes():e.getMinutes()),1===a.length&&(a=`0${a}`)),c+=a;break;case"p":case"P":i||(i=(s?e.getUTCHours():e.getHours())<12?"am":"pm"),c+="p"===d?"am"===i?"AM":"PM":i;break;case"Z":c+=n;break;case"%":c+="%";break;case"Y":c+=e.getFullYear();break;case"m":c+=`0${e.getMonth()+1}`.slice(-2);break;case"d":c+=`0${e.getDate()}`.slice(-2)}u+=1,l=u}return l<r.length&&(c+=r.substr(l)),c}(new Date(r),{fmt:s||"%l:%M %p %Z",timeZoneShort:e.timeZoneShort,useUTC:e.useUTC});var i,o}({timeZoneShort:i,gmtOffSetMilliseconds:n},1e3*t,"%l:%M%p %Z"):"-";break;default:{const e=r?{minimumFractionDigits:r,maximumFractionDigits:r}:{minimumFractionDigits:2,maximumFractionDigits:4};o&&(e.style=o),a.fmt=Intl.NumberFormat(s,e).format(t)}}return a}function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},d.apply(this,arguments)}function b(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const f={exchange:!0,shortName:!0,priceHint:!0,quoteType:!0,marketState:!0,symbol:!0,miniOption:!0,fromcurrency:!0,lastMarket:!0,circulatingSupply:!0,optionsType:!0,longName:!0},m=["exchangeTimezoneName","exchangeTimezoneShortName","regularMarketTime","gmtOffSetMilliseconds"],h={marketState:!0,preMarketTime:!0,postMarketTime:!0,regularMarketTime:!0,extendedMarketTime:!0},p="add";function y({symbols:e,fields:t}){const s=null==t?void 0:t.filter((e=>e)),r=null==e?void 0:e.filter((e=>e));return{symbols:null!=r?r:[],fields:null!=s?s:[]}}"undefined"!=typeof window&&(window.finQuoteStreamer=new class{constructor(){var e=this;b(this,"updateSubscribers",(async function(t,{symbols:s,fields:r,callback:n,priceHint:i,formatStyle:o,permanent:a=!1}){const c=[];for(let d=0;d<s.length;d++){const b=s[d];e.subscriberMap[b]||(e.subscriberMap[b]={});const f=e.subscriberMap[b],m=t===p||r?r:Object.keys(f);for(let s=0;s<m.length;s++){var l;const r=m[s];f[r]||(f[r]=[]),h[r]&&t===p&&void 0===(null==(l=e.quoteData[b])?void 0:l.gmtOffSetMilliseconds)&&c.push(b);const d=f[r];switch(t){case p:{var u;const t={callback:n};"number"==typeof i&&(t.priceHint=i),"string"==typeof o&&(t.formatStyle=o),!0===a&&(f._permanent=a),d.push(t),e.fieldMap[r]=(null!=(u=e.fieldMap[r])?u:0)+1;break}default:{let t=-1;for(let e=0;e<d.length;e++)if(d[e].callback===n){t=e;break}-1!==t&&(d.splice(t,1),e.fieldMap[r]--,0===d.length&&(delete e.subscriberMap[b][r],0===Object.keys(e.subscriberMap[b]).length&&delete e.subscriberMap[b]),0===e.fieldMap[r]&&delete e.fieldMap[r])}}}}c.length>0&&e.seedSymbols(c)})),b(this,"debouncedSeedSymbols",(()=>{let e,t=[];return s=>{clearTimeout(e),t=t.concat(s),e=setTimeout((()=>{this.seedWithQuoteData(t),t=[]}),500)}})),b(this,"seedWithQuoteData",(async function(t){const s=[...new Set(t)].sort();try{const t=await async function(){var e;if(null!=(e=window.finWebCore)&&e.crumb)return window.finWebCore.crumb;const t=new URL(`${a()}/v1/test/getcrumb`),s=await c(t.toString(),{errorMsg:"crumb fetch failed",headers:{"Content-Type":"text/plain"},timeout:1e3});return window.finWebCore.crumb=s,s}(),r=await function({crumb:e="",symbols:t,fields:s,beaconString:r}){const n=new URL(`${a()}/v7/finance/quote`),{finWebCore:i}=window,o={symbols:t.join(","),formatted:"true",crumb:e,lang:i.lang||"en-US",region:i.region||"US",corsDomain:window.location.host};return Object.keys(o).forEach((e=>o[e]&&n.searchParams.append(e,o[e]))),s&&Array.isArray(s)&&n.searchParams.append("fields",s.join(",")),c(n.toString(),{beaconString:r,errorMsg:"quote fetch failed",timeout:1500}).then((e=>{var t;return null==(t=e.quoteResponse)?void 0:t.result}))}({crumb:t,fields:m,symbols:s});r.forEach((t=>{e.quoteData[t.symbol]=Object.assign({},t,e.quoteData[t.symbol])}))}catch(e){console.error(e)}})),b(this,"onUpdate",(e=>{const{data:t}=e,{quoteData:s}=t||{};s&&Object.keys(s).forEach((e=>{var t;const{price:r={},summaryDetail:n={}}=null!=(t=s[e])?t:{},i=d({},r,n);this.quoteData[e]=Object.assign({},this.quoteData[e],i);const o=this.subscriberMap[e];o&&Object.keys(i).forEach((t=>{const s=o[t];if(s)for(let n=0;n<s.length;n++){var r;const{priceHint:o,gmtOffSetMilliseconds:a,exchangeTimezoneShortName:c,timeZoneShortName:l}=this.quoteData[e],d=s[n],b=f[t]?i[t]:u({field:t,value:i[t],lang:(null==(r=window.finWebCore)?void 0:r.lang)||"en-US",priceHint:d.priceHint||o,gmtOffSetMilliseconds:a,timeZoneShort:c||l,formatStyle:d.formatStyle});this.quoteData[e][t]=b,d.callback(b,{field:t,quote:this.quoteData[e]})}}))}))})),b(this,"handleFocus",(()=>{this.pauseSubscription({symbols:Object.keys(this.subscriberMap)},!0)})),b(this,"handleBlur",(()=>{this.pauseSubscription({symbols:Object.keys(this.subscriberMap)})})),b(this,"subscribe",(({symbols:e,fields:t,type:s="streamer",callback:r,priceHint:n,formatStyle:i,permanent:o=!1})=>{var a,c;const l=y({symbols:e,fields:t});var u;(null==(a=l.symbols)?void 0:a.length)>0&&(null==(c=l.fields)?void 0:c.length)>0&&(this.updateSubscribers("add",{symbols:l.symbols,fields:l.fields,priceHint:n,formatStyle:i,permanent:o,callback:r}),this.worker.postMessage({cmd:"subscribe",type:s,crumb:(null==(u=window.finWebCore)?void 0:u.crumb)||"",symbols:Object.keys(this.subscriberMap),fields:Object.keys(this.fieldMap)}))})),b(this,"unsubscribe",(({symbols:e,fields:t,type:s="streamer",callback:r})=>{var n,i;const o=y({symbols:e,fields:t});var a;(null==(n=o.symbols)?void 0:n.length)>0&&(null==(i=o.fields)?void 0:i.length)>0&&(this.updateSubscribers("remove",{symbols:o.symbols,fields:o.fields,callback:r}),this.worker.postMessage({cmd:"unsubscribe",type:s,crumb:(null==(a=window.finWebCore)?void 0:a.crumb)||"",symbols:Object.keys(this.subscriberMap),fields:Object.keys(this.fieldMap)}))})),b(this,"pauseSubscription",(({symbols:e},t=!1)=>{var s;const r=y({symbols:e,fields:[]});if((null==(s=r.symbols)?void 0:s.length)>0){var n;const e=[];let s=[];const i=new Set(r.symbols);Object.entries(this.subscriberMap).forEach((([r,n])=>{const{_permanent:o}=n;(o||(t?i.has(r):!i.has(r)))&&(s=[...s,...Object.keys(n)],e.push(r))})),this.worker.postMessage({cmd:t?"subscribe":"unsubscribe",type:"streamer",crumb:(null==(n=window.finWebCore)?void 0:n.crumb)||"",symbols:e,fields:Array.from(new Set(s))})}})),b(this,"init",(()=>{new URLSearchParams(window.location.search).has("disableStreaming")||(this.subscriberMap={},void 0===r||this.worker||(this.worker=new r,this.worker.addEventListener("message",this.onUpdate)),window.addEventListener("focus",this.handleFocus),window.addEventListener("blur",this.handleBlur),this.initialized||Promise.resolve().then(s.bind(s,8277)).then((()=>{this.initialized=!0})))})),this.subscriberMap={},this.fieldMap={},this.worker=null,this.quoteData={},this.initialized=!1,this.seedSymbols=this.debouncedSeedSymbols()}},window.finQuoteStreamer.init())})()})();